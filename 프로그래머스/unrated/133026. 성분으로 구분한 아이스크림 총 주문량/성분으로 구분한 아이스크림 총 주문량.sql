SELECT DISTINCT INGREDIENT_TYPE, SUM(TOTAL_ORDER) OVER(PARTITION BY INGREDIENT_TYPE) TOTAL_ORDER
  FROM ICECREAM_INFO A
     , FIRST_HALF B
 WHERE A.FLAVOR = B.FLAVOR
 ORDER BY TOTAL_ORDER;